{{ define "main" }}
<div class="container premium-page trade-coach-page">
  <!-- Premium Gate -->
  <div class="premium-gate" id="premium-gate">
    <div class="gate-content">
      <div class="gate-icon">ğŸ“</div>
      <h1>AI Trade Coach</h1>
      <p class="gate-desc">Get personalized feedback on your trades. AI evaluates your entries, exits, risk management, and trading psychology.</p>
      <div class="gate-features">
        <div class="feature-item"><span>ğŸ“</span> Trade Scoring (0-100)</div>
        <div class="feature-item"><span>ğŸ’¡</span> Improvement Tips</div>
        <div class="feature-item"><span>ğŸ§ </span> Psychology Analysis</div>
        <div class="feature-item"><span>ğŸ¯</span> Alternative Entries/Exits</div>
      </div>
      <div class="gate-price">
        <span class="price-amount">âš¡ 50 sats</span>
        <span class="price-period">one-time access</span>
      </div>
      <button class="btn-unlock-premium" id="btn-unlock">Unlock Trade Coach</button>
      <p class="gate-note">Already unlocked? <a href="#" id="check-access">Check access</a></p>
    </div>
  </div>

  <!-- Trade Coach Content -->
  <div class="premium-content" id="premium-content" style="display: none;">
    <header class="coach-header">
      <h1>ğŸ“ AI Trade Coach</h1>
      <p class="subtitle">Get expert feedback on your trading decisions</p>
    </header>

    <!-- Trade Input Form -->
    <section class="trade-input-section">
      <h2>Submit Your Trade</h2>
      <form class="trade-form" id="trade-form">
        <div class="form-row">
          <div class="form-group">
            <label for="trade-direction">Direction</label>
            <select id="trade-direction" required>
              <option value="">Select...</option>
              <option value="long">Long</option>
              <option value="short">Short</option>
            </select>
          </div>
          <div class="form-group">
            <label for="trade-timeframe">Timeframe</label>
            <select id="trade-timeframe" required>
              <option value="">Select...</option>
              <option value="1m">1 minute</option>
              <option value="5m">5 minutes</option>
              <option value="15m">15 minutes</option>
              <option value="1h">1 hour</option>
              <option value="4h">4 hours</option>
              <option value="1d">Daily</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="entry-price">Entry Price ($)</label>
            <input type="number" id="entry-price" placeholder="e.g., 95000" required>
          </div>
          <div class="form-group">
            <label for="stop-loss">Stop Loss ($)</label>
            <input type="number" id="stop-loss" placeholder="e.g., 94000">
          </div>
          <div class="form-group">
            <label for="take-profit">Take Profit ($)</label>
            <input type="number" id="take-profit" placeholder="e.g., 98000">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="position-size">Position Size (%)</label>
            <input type="number" id="position-size" placeholder="e.g., 5" min="0" max="100">
          </div>
          <div class="form-group">
            <label for="trade-outcome">Outcome (if closed)</label>
            <select id="trade-outcome">
              <option value="open">Still Open</option>
              <option value="win">Win</option>
              <option value="loss">Loss</option>
              <option value="breakeven">Breakeven</option>
            </select>
          </div>
        </div>

        <div class="form-group full-width">
          <label for="trade-reasoning">Your Reasoning</label>
          <textarea id="trade-reasoning" rows="4" placeholder="Explain why you took this trade. What was your thesis? What signals did you see?"></textarea>
        </div>

        <div class="form-group full-width">
          <label for="trade-notes">Additional Notes (optional)</label>
          <textarea id="trade-notes" rows="2" placeholder="Any other context: emotions, market conditions, mistakes you noticed..."></textarea>
        </div>

        <button type="submit" class="btn-analyze" id="btn-analyze">
          <span class="btn-text">Analyze My Trade</span>
          <span class="btn-loading" style="display: none;">Analyzing...</span>
        </button>
      </form>
    </section>

    <!-- Analysis Results -->
    <section class="analysis-results" id="analysis-results" style="display: none;">
      <h2>Trade Analysis</h2>

      <!-- Overall Score -->
      <div class="score-display">
        <div class="score-circle">
          <svg viewBox="0 0 100 100">
            <circle class="score-bg" cx="50" cy="50" r="45"/>
            <circle class="score-fill" id="score-circle" cx="50" cy="50" r="45"/>
          </svg>
          <span class="score-value" id="trade-score">--</span>
        </div>
        <div class="score-breakdown">
          <div class="breakdown-item">
            <span class="breakdown-label">Entry Quality</span>
            <div class="breakdown-bar"><div class="breakdown-fill" id="entry-score"></div></div>
          </div>
          <div class="breakdown-item">
            <span class="breakdown-label">Risk Management</span>
            <div class="breakdown-bar"><div class="breakdown-fill" id="risk-score"></div></div>
          </div>
          <div class="breakdown-item">
            <span class="breakdown-label">Trade Logic</span>
            <div class="breakdown-bar"><div class="breakdown-fill" id="logic-score"></div></div>
          </div>
          <div class="breakdown-item">
            <span class="breakdown-label">Position Sizing</span>
            <div class="breakdown-bar"><div class="breakdown-fill" id="sizing-score"></div></div>
          </div>
        </div>
      </div>

      <!-- Feedback Sections -->
      <div class="feedback-grid">
        <div class="feedback-card strengths">
          <h3>âœ… What You Did Well</h3>
          <div class="feedback-content" id="strengths-content">
            <div class="loading-spinner">Analyzing...</div>
          </div>
        </div>

        <div class="feedback-card improvements">
          <h3>âš ï¸ Areas to Improve</h3>
          <div class="feedback-content" id="improvements-content">
            <div class="loading-spinner">Analyzing...</div>
          </div>
        </div>

        <div class="feedback-card psychology">
          <h3>ğŸ§  Psychology Check</h3>
          <div class="feedback-content" id="psychology-content">
            <div class="loading-spinner">Analyzing...</div>
          </div>
        </div>

        <div class="feedback-card alternatives">
          <h3>ğŸ¯ Alternative Approach</h3>
          <div class="feedback-content" id="alternatives-content">
            <div class="loading-spinner">Analyzing...</div>
          </div>
        </div>
      </div>

      <!-- Key Takeaways -->
      <div class="takeaways-section">
        <h3>ğŸ“Œ Key Takeaways</h3>
        <div class="takeaways-content" id="takeaways-content">
          <div class="loading-spinner">Generating takeaways...</div>
        </div>
      </div>

      <!-- Analyze Another -->
      <button class="btn-new-trade" id="btn-new-trade">Analyze Another Trade</button>
    </section>

    <!-- Recent Analyses -->
    <section class="recent-analyses">
      <h2>ğŸ“š Your Recent Analyses</h2>
      <div class="analyses-list" id="analyses-list">
        <p class="no-analyses">No analyses yet. Submit a trade above to get started!</p>
      </div>
    </section>
  </div>
</div>

<script src="{{ "src/js/trade-coach.js" | relURL }}"></script>
{{ end }}
