<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Learn Interactive - Test Page</title>

  <!-- Inline CSS for standalone testing -->
  <style>
    /* Import the compiled CSS - adjust path as needed */
    @import url('/assets/dist/css/shared.css');
    @import url('/assets/dist/css/learn.css');
    @import url('/assets/dist/css/learn-interactive.css');
  </style>

  <!-- Fallback inline styles if CSS files not available -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: #0d1117;
      color: #e6edf3;
      line-height: 1.6;
      padding: 20px;
    }

    .test-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .test-header {
      text-align: center;
      margin-bottom: 40px;
      padding-bottom: 40px;
      border-bottom: 1px solid #30363d;
    }

    .test-header h1 {
      font-size: 2.5rem;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #f7931a 0%, #ffb800 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .test-section {
      margin: 60px 0;
      padding: 30px;
      background: #161b22;
      border: 1px solid #30363d;
      border-radius: 12px;
    }

    .test-section h2 {
      margin-bottom: 20px;
      color: #f7931a;
      font-size: 1.5rem;
    }

    .test-description {
      color: #8d96a0;
      margin-bottom: 20px;
      padding: 15px;
      background: #0d1117;
      border-left: 3px solid #58a6ff;
      border-radius: 4px;
    }

    .button-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin: 20px 0;
    }

    .test-button {
      padding: 10px 20px;
      background: #21262d;
      border: 1px solid #30363d;
      border-radius: 6px;
      color: #e6edf3;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    .test-button:hover {
      border-color: #f7931a;
      background: #30363d;
    }

    .test-button.primary {
      background: linear-gradient(135deg, #f7931a 0%, #ffb800 100%);
      color: #fff;
      border: none;
    }

    .test-result {
      margin-top: 20px;
      padding: 15px;
      background: #0d1117;
      border-radius: 6px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      color: #3fb950;
      display: none;
    }

    .test-result.show {
      display: block;
    }

    .article-content {
      color: #e6edf3;
      line-height: 1.8;
    }

    .article-content h3 {
      margin: 30px 0 15px;
      color: #f7931a;
    }

    .article-content p {
      margin-bottom: 15px;
    }

    .spacer {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #8d96a0;
      font-size: 14px;
    }
  </style>
</head>

<body data-article-id="test-article-123">

  <div class="test-container">

    <!-- Header -->
    <div class="test-header">
      <h1>Learn Interactive Test Page</h1>
      <p style="color: #8d96a0; margin-top: 10px;">
        This page tests all interactive learn components.
        <br>Open browser console to see debug output.
      </p>
    </div>

    <!-- Test 1: Progress Tracking -->
    <div class="test-section">
      <h2>1. Progress Tracking</h2>
      <div class="test-description">
        <strong>Test:</strong> Scroll down this page. The progress bar should update automatically.
        Reload the page - progress should persist.
      </div>

      <section class="progress-container" data-article-id="test-article-123">
        <div class="progress-header">
          <h3>Your Progress</h3>
          <span class="progress-text">0%</span>
        </div>
        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
          <div class="progress-fill" style="width: 0%"></div>
        </div>
      </section>

      <div class="button-group">
        <button class="test-button" onclick="testProgress(25)">Set 25%</button>
        <button class="test-button" onclick="testProgress(50)">Set 50%</button>
        <button class="test-button" onclick="testProgress(75)">Set 75%</button>
        <button class="test-button" onclick="testProgress(100)">Set 100%</button>
        <button class="test-button" onclick="testGetProgress()">Get Progress</button>
        <button class="test-button" onclick="testMarkComplete()">Mark Complete</button>
      </div>

      <div class="test-result" id="progress-result"></div>
    </div>

    <!-- Test 2: Quiz -->
    <div class="test-section">
      <h2>2. Interactive Quiz</h2>
      <div class="test-description">
        <strong>Test:</strong> Answer the quiz questions and submit.
        Score is saved in localStorage. Try the retry button.
      </div>

      <form class="quiz-container" data-quiz-id="test-quiz-1" data-article-id="test-article-123">
        <div class="quiz-header">
          <h3>Bitcoin Knowledge Quiz</h3>
          <p class="quiz-subtitle">Test your understanding of Bitcoin</p>
          <span class="quiz-previous-score"></span>
        </div>

        <div class="quiz-question" data-correct="b">
          <div class="question-text">
            <span class="question-number">1.</span>
            <span>What is the maximum supply of Bitcoin?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option">
              <input type="radio" id="q1a" name="question-0" value="a">
              <label for="q1a">100 million BTC</label>
            </div>
            <div class="quiz-option">
              <input type="radio" id="q1b" name="question-0" value="b">
              <label for="q1b">21 million BTC (Correct)</label>
            </div>
            <div class="quiz-option">
              <input type="radio" id="q1c" name="question-0" value="c">
              <label for="q1c">Unlimited</label>
            </div>
          </div>
        </div>

        <div class="quiz-question" data-correct="a">
          <div class="question-text">
            <span class="question-number">2.</span>
            <span>Who created Bitcoin?</span>
          </div>
          <div class="quiz-options">
            <div class="quiz-option">
              <input type="radio" id="q2a" name="question-1" value="a">
              <label for="q2a">Satoshi Nakamoto (Correct)</label>
            </div>
            <div class="quiz-option">
              <input type="radio" id="q2b" name="question-1" value="b">
              <label for="q2b">Vitalik Buterin</label>
            </div>
            <div class="quiz-option">
              <input type="radio" id="q2c" name="question-1" value="c">
              <label for="q2c">Elon Musk</label>
            </div>
          </div>
        </div>

        <div class="quiz-actions">
          <button type="submit" class="quiz-submit">Submit Quiz</button>
        </div>

        <div class="quiz-results">
          <h4>Quiz Results</h4>
          <div class="quiz-score">0/0</div>
          <p class="quiz-message"></p>
          <button type="button" class="quiz-retry">Try Again</button>
        </div>
      </form>
    </div>

    <!-- Test 3: Code Examples -->
    <div class="test-section">
      <h2>3. Code Examples with Copy</h2>
      <div class="test-description">
        <strong>Test:</strong> Click the copy button. Should show "Copied!" feedback.
        Paste into an editor to verify.
      </div>

      <div class="code-example">
        <pre><code>// Example: Generate a Bitcoin address
const bitcoin = require('bitcoinjs-lib');
const keyPair = bitcoin.ECPair.makeRandom();
const { address } = bitcoin.payments.p2pkh({
  pubkey: keyPair.publicKey
});
console.log('Your Bitcoin Address:', address);</code></pre>
      </div>

      <div class="code-example">
        <pre><code>// Example: Calculate transaction fee
const txSize = 250; // bytes
const feeRate = 50; // sat/byte
const totalFee = txSize * feeRate;
console.log(`Fee: ${totalFee} satoshis`);</code></pre>
      </div>
    </div>

    <!-- Test 4: Expandable Sections -->
    <div class="test-section">
      <h2>4. Expandable Sections</h2>
      <div class="test-description">
        <strong>Test:</strong> Click to expand/collapse. Try navigating to
        <a href="#advanced-topic" style="color: #58a6ff;">this link</a> - section should auto-expand.
      </div>

      <div class="expandable-section">
        <button class="section-toggle" aria-expanded="false">
          <h3 class="section-title">What is a Blockchain?</h3>
          <span class="toggle-icon">▼</span>
        </button>
        <div class="section-content">
          <div class="section-inner">
            <p>A blockchain is a distributed ledger technology that records transactions across multiple computers in a way that makes it nearly impossible to alter retroactively without the alteration of all subsequent blocks.</p>
            <p>Key features include:</p>
            <ul>
              <li>Decentralization</li>
              <li>Immutability</li>
              <li>Transparency</li>
              <li>Security through cryptography</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="expandable-section">
        <button class="section-toggle" aria-expanded="false">
          <h3 class="section-title">Advanced Topics</h3>
          <span class="toggle-icon">▼</span>
        </button>
        <div class="section-content">
          <div class="section-inner">
            <h4 id="advanced-topic">Lightning Network</h4>
            <p>The Lightning Network is a second-layer payment protocol that operates on top of Bitcoin. It enables fast, low-cost transactions between participating nodes.</p>

            <div class="code-example">
              <pre><code>// Lightning Network payment example
const invoice = await lnd.addInvoice({
  value: 1000, // satoshis
  memo: 'Coffee payment'
});
console.log('Pay this invoice:', invoice.payment_request);</code></pre>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Test 5: Interactive Highlights -->
    <div class="test-section">
      <h2>5. Interactive Highlights</h2>
      <div class="test-description">
        <strong>Test:</strong> Visual callout boxes with different types.
      </div>

      <div class="interactive-highlight tip">
        <div class="highlight-title">Pro Tip</div>
        <p>Always verify addresses before sending Bitcoin. One wrong character can result in lost funds.</p>
      </div>

      <div class="interactive-highlight warning">
        <div class="highlight-title">Important Warning</div>
        <p>Never share your private keys with anyone. Not your keys, not your Bitcoin!</p>
      </div>

      <div class="interactive-highlight">
        <div class="highlight-title">Did You Know?</div>
        <p>Bitcoin's difficulty adjusts every 2,016 blocks (approximately every two weeks) to maintain a 10-minute average block time.</p>
      </div>

      <div class="interactive-highlight danger">
        <div class="highlight-title">Security Alert</div>
        <p>Phishing attacks targeting crypto users are increasingly common. Always verify URLs and use hardware wallets for significant amounts.</p>
      </div>
    </div>

    <!-- Test 6: Completion Badge -->
    <div class="test-section">
      <h2>6. Completion Badge</h2>
      <div class="test-description">
        <strong>Test:</strong> Click "Show Badge" to see the completion badge animate in.
      </div>

      <div style="position: relative; padding: 20px; background: #0d1117; border-radius: 8px;">
        <div class="completion-badge" id="test-badge" aria-hidden="true">Completed</div>
        <p>This is a sample article card or content area.</p>
      </div>

      <div class="button-group" style="margin-top: 20px;">
        <button class="test-button" onclick="showBadge()">Show Badge</button>
        <button class="test-button" onclick="hideBadge()">Hide Badge</button>
      </div>
    </div>

    <!-- Test 7: LocalStorage Inspection -->
    <div class="test-section">
      <h2>7. LocalStorage Data</h2>
      <div class="test-description">
        <strong>Test:</strong> View and manage stored data.
      </div>

      <div class="button-group">
        <button class="test-button primary" onclick="showStorage()">Show All Data</button>
        <button class="test-button" onclick="clearStorage()">Clear All Data</button>
      </div>

      <div class="test-result" id="storage-result"></div>
    </div>

    <!-- Article Content for Scroll Testing -->
    <div class="article-content">
      <h3>Sample Article Content</h3>
      <p>Scroll down through this content to test automatic progress tracking. The progress bar at the top should update as you scroll.</p>

      <h3>Bitcoin History</h3>
      <p>Bitcoin was created in 2008 by an unknown person or group using the pseudonym Satoshi Nakamoto. The Bitcoin white paper was published on October 31, 2008, and the first Bitcoin software was released on January 9, 2009.</p>

      <div class="spacer">[ Scroll down to continue... ]</div>

      <h3>How Bitcoin Works</h3>
      <p>Bitcoin operates on a peer-to-peer network where transactions are verified by network nodes through cryptography and recorded in a public distributed ledger called a blockchain.</p>

      <div class="spacer">[ Keep scrolling... ]</div>

      <h3>Mining</h3>
      <p>Bitcoin mining is the process by which new bitcoins are entered into circulation. It is also the way the network confirms new transactions and is a critical component of the blockchain ledger's maintenance and development.</p>

      <div class="spacer">[ Almost there... ]</div>

      <h3>Conclusion</h3>
      <p>Bitcoin represents a fundamental shift in how we think about money and value transfer. Understanding its core concepts is essential for anyone interested in cryptocurrency.</p>

      <div style="padding: 40px; text-align: center; color: #8d96a0;">
        <p>End of article. You should now be at 95%+ progress.</p>
        <p>The article should auto-complete and show the completion badge.</p>
      </div>
    </div>

  </div>

  <!-- Include the learn-interactive.js -->
  <script src="/static/dist/js/learn-interactive.js"></script>

  <!-- Test helper functions -->
  <script>
    // Helper functions for testing

    function testProgress(percentage) {
      LearnInteractive.progress.saveProgress('test-article-123', percentage);
      showResult('progress-result', `Progress set to ${percentage}%`);
    }

    function testGetProgress() {
      const progress = LearnInteractive.progress.getProgress();
      showResult('progress-result', JSON.stringify(progress, null, 2));
    }

    function testMarkComplete() {
      LearnInteractive.progress.markComplete('test-article-123');
      showResult('progress-result', 'Article marked as complete!');
    }

    function showBadge() {
      const badge = document.getElementById('test-badge');
      badge.classList.add('show');
    }

    function hideBadge() {
      const badge = document.getElementById('test-badge');
      badge.classList.remove('show');
    }

    function showStorage() {
      const data = {
        progress: localStorage.getItem('btcsignal_learn_progress'),
        quizScores: localStorage.getItem('btcsignal_quiz_scores'),
        completed: localStorage.getItem('btcsignal_completed_sections')
      };

      let output = 'LocalStorage Data:\n\n';
      for (const [key, value] of Object.entries(data)) {
        if (value) {
          output += `${key}:\n${JSON.stringify(JSON.parse(value), null, 2)}\n\n`;
        } else {
          output += `${key}: (empty)\n\n`;
        }
      }

      showResult('storage-result', output);
    }

    function clearStorage() {
      if (confirm('Clear all learning data?')) {
        localStorage.removeItem('btcsignal_learn_progress');
        localStorage.removeItem('btcsignal_quiz_scores');
        localStorage.removeItem('btcsignal_completed_sections');
        showResult('storage-result', 'All data cleared!');
        setTimeout(() => location.reload(), 1000);
      }
    }

    function showResult(id, message) {
      const el = document.getElementById(id);
      el.textContent = message;
      el.classList.add('show');
      setTimeout(() => el.classList.remove('show'), 5000);
    }

    // Console logging for debugging
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Learn Interactive Test Page Loaded');
      console.log('LearnInteractive API:', LearnInteractive);
      console.log('Current Progress:', LearnInteractive.progress.getProgress());
      console.log('Completed Articles:', LearnInteractive.progress.getCompleted());
    });
  </script>

</body>
</html>
